<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban Ploca</title>
    <link rel="stylesheet" href="style1.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>

    <h1>Kanban ploca</h1>
    
    <div class="buttons">
        <button id="addTaskBtn">Dodaj zadatak</button>
        <button id="saveBoardBtn">Snimi</button>
        <button id="savePdfBtn">Preuzmi PDF</button>
        <button id="sendEmailBtn">Pošalji mailom</button>
        <button id="clearBoardBtn">Ocisti plocu</button>
    </div>
    
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <h3>Dodaj zadatak</h3>
            <input type="text" id="taskInput" placeholder="Vas zadatak..." />
            <div class="modal-buttons">
                <button id="modalAdd">Dodaj</button>
                <button id="modalCancel">Ponisti</button>
            </div>
        </div>
    </div>
    
    <div id="clearModal" class="modal">
        <div class="modal-content">
            <h3>Ocisti cijelu plocu?</h3>
            <p>Ova se radnja ne moze ponistiti!</p>
            <div class="modal-buttons">
                <button id="clearYes" style="background:#e74c3c;">Ocisti</button>
                <button id="clearNo">Ponisti</button>
            </div>
        </div>
    </div>
    
    <div id="emailModal" class="modal">
        <div class="modal-content">
            <h3>Pošalji Kanban ploču mailom</h3>
            <input type="email" id="emailInput" placeholder="Unesite email adresu..." />
            <div class="modal-buttons">
                <button id="emailSend">Pošalji</button>
                <button id="emailCancel">Poništi</button>
            </div>
        </div>
    </div>
    
    <div class="board" id="kanbanContent">
        <div class="column" data-status="todo">
            <h2>To Do</h2>
            <div class="taskList"></div>
        </div>
        
        <div class="column" data-status="progress">
            <h2>In progress</h2>
            <div class="taskList"></div>
        </div>
        
        <div class="column" data-status="done">
            <h2>Done</h2>
            <div class="taskList"></div>
        </div>
    </div>

    <footer>
        <p>Web programiranje 2025 © Internacionalna poslovno-informaciona akademija Tuzla</p>
    </footer>

    <script src="javascript1.js"></script>
    <script>
        // PDF Export Functionality
        document.getElementById('savePdfBtn').addEventListener('click', () => {
            const element = document.getElementById('kanbanContent');
            const options = {
                margin: 0.5,
                filename: 'Kanban_Ploča.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(options).from(element).save();
        });

        // Email Modal Functionality
        document.getElementById('sendEmailBtn').addEventListener('click', () => {
            document.getElementById('emailModal').style.display = 'block';
        });

        document.getElementById('emailCancel').addEventListener('click', () => {
            document.getElementById('emailModal').style.display = 'none';
            document.getElementById('emailInput').value = '';
        });

        document.getElementById('emailSend').addEventListener('click', () => {
            const email = document.getElementById('emailInput').value;
            if (email) {
                // Get all tasks from the board
                const tasks = [];
                document.querySelectorAll('.task').forEach(task => {
                    tasks.push(task.textContent);
                });

                // Create email content
                const subject = 'Kanban Ploča - Trenutni zadaci';
                const body = `Trenutni zadaci na Kanban ploči:\n\n` +
                            `TO DO:\n${getTasksByColumn('todo')}\n\n` +
                            `IN PROGRESS:\n${getTasksByColumn('progress')}\n\n` +
                            `DONE:\n${getTasksByColumn('done')}\n\n` +
                            `\nPoslano sa Kanban aplikacije.`;

                // Create mailto link
                const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                // Open email client
                window.location.href = mailtoLink;
                
                // Close modal and clear input
                document.getElementById('emailModal').style.display = 'none';
                document.getElementById('emailInput').value = '';
            } else {
                alert('Molimo unesite email adresu!');
            }
        });

        // Helper function to get tasks by column
        function getTasksByColumn(status) {
            const column = document.querySelector(`[data-status="${status}"]`);
            const tasks = Array.from(column.querySelectorAll('.task')).map(task => 
                `• ${task.textContent}`
            );
            return tasks.length > 0 ? tasks.join('\n') : 'Nema zadataka';
        }

        // Close email modal when clicking outside
        window.addEventListener('click', (event) => {
            const emailModal = document.getElementById('emailModal');
            if (event.target === emailModal) {
                emailModal.style.display = 'none';
                document.getElementById('emailInput').value = '';
            }
        });
    </script>
</body>
</html>