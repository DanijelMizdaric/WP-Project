<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style3.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <title>Interaktivni Whiteboard</title>
</head>
<body>
    <h1>üñäÔ∏è Interaktivni Whiteboard</h1>

    <!-- Toolbar for controls -->
    <div class="toolbar">
        <label for="colorPicker">Boja:</label>
        <input type="color" id="colorPicker" value="#000000">

        <label for="brushSize">ƒåetka:</label>
        <input type="range" id="brushSize" min="1" max="20" value="3">

        <button id="eraserBtn">Bri≈°i</button>
        <button id="clearBtn">ƒåista ploƒça</button>
        <button id="saveBtn">Snimi</button>
        <button id="savePdfBtn">Preuzmi PDF</button>
        <button id="sendEmailBtn">Po≈°alji mailom</button>
    </div>

    <!-- Drawing area -->
    <canvas id="board" width="900" height="500"></canvas>

    <!-- Email Modal -->
    <div id="emailModal" class="modal">
        <div class="modal-content">
            <h3>Po≈°alji Whiteboard crte≈æ mailom</h3>
            <input type="email" id="emailInput" placeholder="Unesite email adresu..." />
            <div class="modal-buttons">
                <button id="emailSend">Po≈°alji</button>
                <button id="emailCancel">Poni≈°ti</button>
            </div>
        </div>
    </div>

    <footer>
        Web programiranje 2025 ¬© Internacionalna poslovno-informaciona akademija Tuzla
    </footer>

    <script src="javascript3.js"></script>
    <script>
        // PDF Export Functionality
        document.getElementById('savePdfBtn').addEventListener('click', () => {
            const canvas = document.getElementById('board');
            
            // Create a temporary container for the canvas
            const container = document.createElement('div');
            container.style.padding = '20px';
            container.style.backgroundColor = 'white';
            container.style.textAlign = 'center';
            
            // Add title
            const title = document.createElement('h2');
            title.textContent = 'Interaktivni Whiteboard Crte≈æ';
            title.style.color = '#2c3e50';
            title.style.marginBottom = '20px';
            container.appendChild(title);
            
            // Add canvas as image
            const img = document.createElement('img');
            img.src = canvas.toDataURL('image/png');
            img.style.maxWidth = '100%';
            img.style.border = '2px solid #e1e8ed';
            img.style.borderRadius = '10px';
            container.appendChild(img);
            
            // Add footer
            const footer = document.createElement('p');
            footer.textContent = 'Kreirano sa Interaktivni Whiteboard aplikacijom';
            footer.style.marginTop = '20px';
            footer.style.color = '#6c757d';
            footer.style.fontSize = '12px';
            container.appendChild(footer);

            const options = {
                margin: 0.5,
                filename: 'Whiteboard_Crte≈æ.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    backgroundColor: '#ffffff'
                },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
            };
            
            html2pdf().set(options).from(container).save();
        });

        // Email Modal Functionality
        document.getElementById('sendEmailBtn').addEventListener('click', () => {
            document.getElementById('emailModal').style.display = 'block';
        });

        document.getElementById('emailCancel').addEventListener('click', () => {
            document.getElementById('emailModal').style.display = 'none';
            document.getElementById('emailInput').value = '';
        });

        document.getElementById('emailSend').addEventListener('click', () => {
            const email = document.getElementById('emailInput').value;
            if (email) {
                const canvas = document.getElementById('board');
                const drawingDataURL = canvas.toDataURL('image/png');
                
                // Create email content
                const subject = 'Moj Whiteboard Crte≈æ';
                const body = `Pogledajte moj crte≈æ sa Interaktivnog Whiteboarda!\n\n` +
                            `Crte≈æ je prilo≈æen kao slika ili mo≈æete pregledati u prilogu.\n\n` +
                            `Poslano sa Interaktivni Whiteboard aplikacije.\n\n` +
                            `Datum: ${new Date().toLocaleDateString()}`;

                // Create mailto link with the drawing as attachment reference
                // Note: Direct image embedding in mailto is limited, so we reference it
                const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                // Open email client
                window.location.href = mailtoLink;
                
                // For a more advanced solution, you could upload the image to a service
                // and include the link in the email body
                
                // Close modal and clear input
                document.getElementById('emailModal').style.display = 'none';
                document.getElementById('emailInput').value = '';
            } else {
                alert('Molimo unesite email adresu!');
            }
        });

        // Close email modal when clicking outside
        window.addEventListener('click', (event) => {
            const emailModal = document.getElementById('emailModal');
            if (event.target === emailModal) {
                emailModal.style.display = 'none';
                document.getElementById('emailInput').value = '';
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                document.getElementById('emailModal').style.display = 'none';
                document.getElementById('emailInput').value = '';
            }
        });

        // Enhanced email function with image download suggestion
        function sendEmailWithDrawing(email) {
            const canvas = document.getElementById('board');
            const link = document.createElement('a');
            link.download = 'whiteboard_crte≈æ.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            // After downloading, open email client
            setTimeout(() => {
                const subject = 'Moj Whiteboard Crte≈æ';
                const body = `Pogledajte moj crte≈æ sa Interaktivnog Whiteboarda!\n\n` +
                            `Crte≈æ je preuzet i prilo≈æen ovom mailu.\n\n` +
                            `Poslano sa Interaktivni Whiteboard aplikacije.`;
                
                const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.location.href = mailtoLink;
            }, 1000);
        }
    </script>
</body>
</html>